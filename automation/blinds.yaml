  - alias: 'blind_close_sunset'
    trigger:
      - platform: sun
        event: sunset
    action:
        - service: cover.close_cover
          data:
            entity_id: cover.blind

  - alias: 'blind_open_sunset_week'
    trigger:
      - platform: time
        at: '08:00:00'
    condition: 
      - condition: time
        weekday:
          - mon
          - tue
          - wed
          - thu
          - fri
    action:
        - service: cover.open_cover
          data:
            entity_id: cover.blind

  - alias: 'blind_open_sunset_weekend'
    trigger:
      - platform: time
        at: '11:00:00'
    condition: 
      - condition: time
        weekday:
          - sat
          - sun
    action:
        - service: cover.open_cover
          data:
            entity_id: cover.blind

  - alias: 'Close the blind when its sunny'
    trigger:
      - platform: time
        minutes: '/15'
        seconds: 00
    condition: 
      condition: and
      conditions:
      - condition: state
        entity_id: sun.sun
        state: above_horizon
      - condition: time
        after: '11:00:00'
      # - condition: and
      #   conditions:
      #   - condition: template
      #     value_template: '{{ states.sun.sun.attributes.azimuth | float > 215 }}'
      #   - condition: template
      #     value_template: '{{ states.sun.sun.attributes.azimuth | float < 292 }}'
      - condition: or
        conditions:
        - condition: numeric_state
          entity_id: sensor.weather_temperature
          above: '19'
        - condition: numeric_state
          entity_id: sensor.temperature
          above: '22'
    action:
        - service: cover.set_cover_position
          data_template:
            entity_id: cover.blind
            position: >-
              {%- set elevation = states.sun.sun.attributes.elevation | float -%}
              {%- set azimuth = states.sun.sun.attributes.azimuth | float -%}
              {%- if azimuth > 200 and azimuth < 292 -%}
                {{ ([[ elevation | round | int, 100] |min, 0] |max) | int }}
              {%- else -%}
                100
              {%- endif -%}

  # if el > 12 and az > 215 and az < 292:
  # pos 75
  # elif el > 35
  # pos 50
  # el 0